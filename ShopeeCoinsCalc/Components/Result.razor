@using ShopeeCoinsCalc.Models


@if(ShowResult)
{
	<h3>Result</h3>
	<!-- 使用 Bootstrap 的標準對話窗標記宣告 -->

	    <div class="modal" tabindex="-1" role="dialog" style="display:block; border: 2px solid black">
        <div class="modal-dialog" role="document" style="max-width: 80vw">
            <div class="modal-content">

<div style="margin: 20px;">
	<p>含轉盤共 @ViewModel.RetrivedCount 場直播蝦幣</p>
	<p>總共賺了 @ViewModel.TotalAmount 蝦幣</p>

	<div style="display: flex; flex-wrap: wrap;">
						@if (ViewModel.SummaryData != null)
						{
							var groupedData = ViewModel.SummaryData
							.Select((item, index) => new { item, index })
							.GroupBy(x => x.index / 5)
							.Select(g => g.Select(x => x.item).ToList())
							.ToList();

							foreach (var group in groupedData)
							{
								<table class="table" cellpadding="1px" cellspacing="1px" style="width: auto; border-collapse: collapse; max-width: 100%; border: 2px solid black; margin: 10px;">
									<thead>
										<tr>
											<th style="border: 1px solid black; padding: 8px; text-align: right;">蝦幣</th>
											<th style="border: 1px solid black; padding: 8px; text-align: right;">次數</th>
										</tr>
									</thead>
									<tbody>
										@foreach (var g in group)
										{
											<tr>
												<td style="border: 1px solid black; padding: 8px; text-align: right;">@g.Key</td>
												<td style="border: 1px solid black; padding: 8px; text-align: right;">@g.Count()</td>
											</tr>
										}
									</tbody>
								</table>
							}

						}
	</div>

	<br />

	<button class="btn-info" @onclick="Close" >Close</button>
</div>
		</div>
	</div>
</div>
}

@code{
	[Parameter]
	public bool ShowResult { get; set; } = false;
	[Parameter]
	public ResultViewModel ViewModel { get; set; } = new ResultViewModel();

	protected override void OnInitialized()
	{
		
	}
	private void Close()
	{
		ShowResult = false;
		ViewModel.ShowResult = false;
		StateHasChanged();
	}
}